{
	"loss": {
		"otype": "Huber"
	},
	"optimizer": {
		"otype": "Ema",
		"decay": 0.95,
		"nested": {
			"otype": "ExponentialDecay",
			"nested": {
				"otype": "Adam",
				"learning_rate": 5e-3,
				"beta1": 0.9,
				"beta2": 0.99,
				"epsilon": 1e-15,
				"l2_reg": 1e-6,
				"optimize_delta_params": false,
				"optimize_canonical_params": true,
				"optimize_params_components": {
					"rgb_network": true
				}
			}
		}
	},
	"encoding": {
		"otype": "HashGrid",
		"n_levels": 14,
		"n_features_per_level": 2,
		"log2_hashmap_size": 19,
		"base_resolution": 16,
		"top_resolution": 2048,
		"valid_level_scale": 0.02,
		"base_valid_level_scale": 0.2,
		"base_training_step": 200
	},
	"network": {
		"otype": "FullyFusedMLP",
		"activation": "ReLU",
		"output_activation": "None",
		"n_neurons": 64,
		"n_hidden_layers": 1,
		"sdf_bias": -0.1
	},
	"dir_encoding": {
		"otype": "Composite",
		"nested": [
			{
				"n_dims_to_encode": 3,
				"otype": "SphericalHarmonics",
				"degree": 4
			},
			{
				"otype": "Identity",
				"n_bins": 4,
				"degree": 4
			}
		]
	},
	"rgb_network": {
		"otype": "FullyFusedMLP",
		"activation": "ReLU",
		"output_activation": "None",
		"n_neurons": 64,
		"n_hidden_layers": 2
	},
	"hyperparams": {
		"linear_color": false,
		"first_frame_max_training_step": 20000,
		"ek_loss_weight": 0.05,
		"anneal_end": 5000,
		"use_bgnerf": false,
		"render_bgnerf": false,
		"render_neus": true,
		"batch_size": 262144,
		"batch_size_bg": 131072
	} ,
	"globalmove": {
		"optimizer": {
			"otype": "Ema",
			"decay": 0.95,
			"nested": {
				"otype": "ExponentialDecay",
				"decay_start": 6000,
				"decay_interval": 25,
				"decay_base": 0.99,
				"nested": {
					"otype": "Adam",
					"learning_rate": 1e-3,
					"beta1": 0.9,
					"beta2": 0.99,
					"beta3": 0.9,
					"beta_shampoo": 0.0,
					"epsilon": 1e-10,
					"identity": 0.0001,
					"cg_on_momentum": false,
					"frobenius_normalization": true,
					"l2_reg": 1e-10
				}
			}
		}
	} ,
	"bg_network": {
		"optimizer": {
			"otype": "Ema",
			"decay": 0.95,
			"nested": {
				"otype": "ExponentialDecay",
				"nested": {
					"otype": "Adam",
					"learning_rate": 1e-2,
					"beta1": 0.9,
					"beta2": 0.99,
					"epsilon": 1e-15,
					"l2_reg": 1e-6
				}
			}
		},
		"encoding": {
			"otype": "Frequency",
			"n_frequencies": 6
		},
		// "encoding": {
		// 	// "otype": "Frequency",
		// 	"otype": "HannWindowFrequency",
		// 	"hann_start_iters": -50,
		// 	"hann_end_iters": 500,
		// 	"n_frequencies": 6
		// },
		// "encoding": {
		// 	"otype": "HashGrid",
		// 	"n_levels": 16,
		// 	"n_features_per_level": 2,
		// 	"log2_hashmap_size": 19,
		// 	"base_resolution": 16,
		// 	"top_resolution": 2048
		// },
		"network": {
			"otype": "FullyFusedMLP",
			"activation": "ReLU",
			"output_activation": "None",
			"n_neurons": 64,
			"n_hidden_layers": 1
		},
		"dir_encoding": {
			"otype": "Composite",
			"nested": [
				{
					"n_dims_to_encode": 3,
					"otype": "SphericalHarmonics",
					"degree": 4
				},
				{
					"otype": "Identity",
					"n_bins": 4,
					"degree": 4
				}
			]
		},
		"rgb_network": {
			"otype": "FullyFusedMLP",
			"activation": "ReLU",
			"output_activation": "None",
			"n_neurons": 64,
			"n_hidden_layers": 2
		}
	}
}

